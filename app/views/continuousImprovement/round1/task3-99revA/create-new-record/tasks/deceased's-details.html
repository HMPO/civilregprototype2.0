{% extends "layouts/main.html" %}

{% block pageTitle %}
Deceased's details – {{ serviceName }} – GOV.UK Prototype Kit
{% endblock %}

{% block beforeContent %}
{% from "govuk/components/phase-banner/macro.njk" import govukPhaseBanner %}

{{ govukPhaseBanner({
  tag: {
    text: "Prototype"
  },
  html: 'This is a prototype, not the real service.'
}) }}

{{ govukBackLink({
  text: "Back",
  href: "javascript:window.history.back()"
}) }}
{% endblock %}

{% block content %}

<div class="govuk-width-container">
  <main class="govuk-main-wrapper" id="main-content" role="main">


    <div class="govuk-grid-row">
      <div class="govuk-grid-column-two-thirds">

        <form class="form" action="age-of-deceased" method="post">

          <h1 class="govuk-heading-l">
           Deceased's details
          </h1>

          <div class="govuk-form-group">
            <label class="govuk-label govuk-label--s" for="deceased-first-name">
                First name
            </label>
            <input class="govuk-input govuk-!-width-one-half" id="deceased-first-name" name="deceasedFirstName" value="{{data['deceasedFirstName']}}">
          </div>
          <div class="govuk-form-group">
            <label class="govuk-label govuk-label--s" for="deceased-middle-name">
              Middle name 1
            </label>
            <input class="govuk-input govuk-!-width-one-half" id="deceased-middle-name" name="deceasedMiddleName" value="{{data['deceasedMiddleName']}}">
            <p class="govuk-body">
              <a href="#" class="govuk-link">Add more middle names</a>
            </p>
          </div>
          <div class="govuk-form-group">
            <label class="govuk-label govuk-label--s" for="deceased-last-name">
              Last name
            </label>
            <input class="govuk-input govuk-!-width-one-half" id="deceased-last-name" name="deceasedLastName" value="{{data['deceasedLastName']}}">
          </div>

          <div class="govuk-form-group">
            <fieldset class="govuk-fieldset" role="group" aria-describedby="date-of-death-known-hint" id="date-of-death-known-fieldset">
              <legend class="govuk-fieldset__legend govuk-fieldset__legend--l">
                <h3 class="govuk-heading-s govuk-!-margin-bottom-1">
                  Is the deceased’s date of death known?
                </h3>
              </legend>
              <div class="govuk-radios" data-module="govuk-radios">
                <div class="govuk-radios__item">
                  <input class="govuk-radios__input" id="date-of-death-known-1" name="date-of-death-known" type="radio" value="Yes, their full or partial date of death" {{ checked("date-of-death-known", "Yes, their full or partial date of death") }} data-aria-controls="conditional-date-of-death-known-1">
                  <label class="govuk-label govuk-radios__label" for="date-of-death-known-1">
                    Yes, their full or partial date of death
                  </label>
                </div>
                <div class="govuk-radios__conditional govuk-radios__conditional--hidden" id="conditional-date-of-death-known-1">
                  <div class="govuk-form-group">
                    <fieldset class="govuk-fieldset" role="group"  id="date-of-death-fieldset" aria-describedby="date-of-death1">
                     <legend class="govuk-fieldset__legend govuk-fieldset__legend--s">
                     Enter the date of death
                     </legend>
                     <div id="date-of-death1-hint" class="govuk-hint">
                      For example, 23 11 2024 or 11 2024.
                     </div>
                     <div class="govuk-date-input" id="date-of-death1">
                       <div class="govuk-date-input__item">
                         <div class="govuk-form-group">
                           <label class="govuk-label govuk-date-input__label" for="day-of-death">
                           Day
                           </label>
                           <input class="govuk-input govuk-date-input__input govuk-input--width-2" id="day-of-death" name="day-of-death" value="{{data['day-of-death']}}">
                         </div>
                       </div>
                       <div class="govuk-date-input__item">
                         <div class="govuk-form-group">
                           <label class="govuk-label govuk-date-input__label" for="month-of-death">
                           Month
                           </label>
                           <input class="govuk-input govuk-date-input__input govuk-input--width-2" id="month-of-death" name="month-of-death" value="{{data['month-of-death']}}">
                         </div>
                       </div>
                       <div class="govuk-date-input__item">
                         <div class="govuk-form-group">
                           <label class="govuk-label govuk-date-input__label" for="year-of-death">
                         Year
                           </label>
                           <input class="govuk-input govuk-date-input__input govuk-input--width-4" id="year-of-death" name="year-of-death" value="{{data['year-of-death']}}" >
                         </div>
                       </div>
                     </div>
                    </fieldset>
                   </div>
                  <div class="govuk-form-group">
                    <fieldset class="govuk-fieldset"  role="group" id="yes-qualifier-fieldset">
                        <legend class="govuk-fieldset__legend govuk-fieldset__legend--s">
                          Set how the date will print on the register page
                        </legend>
                        <p class="govuk-body-m">
                          Date qualifier 
                           </p>
                        <div class="govuk-radios" data-module="govuk-radios">
                          <div class="govuk-radios__item">
                            <input class="govuk-radios__input" id="qualifier-1" name="qualifier" type="radio" value="No-qualifier" {{ checked("qualifier", "No-qualifier") }} >
                            <label class="govuk-label govuk-radios__label" for="qualifier-1">
                              No qualifier
                            </label>
                            <div id="qualifier-item-hint" class="govuk-hint govuk-radios__hint">
                              If the exact date of death is known.
                            </div>
                          </div>
                          <div class="govuk-radios__item">
                            <input class="govuk-radios__input" id="qualifier-2" name="qualifier" type="radio" value="On-or-about" {{ checked("qualifier", "On-or-about") }} >
                            <label class="govuk-label govuk-radios__label" for="qualifier-2">
                              On or about
                            </label>
                            <div id="qualifier-item-hint" class="govuk-hint govuk-radios__hint">
                              If the date of death is partial or uncertain.
                            </div>
                          </div>
                        </div>
                      </fieldset>
                    </div>
                    <div class="govuk-form-group">
                      <label class="govuk-label" for="one-half">
                        Date
                      </label>
                      <div id="event-name-hint" class="govuk-hint">
                        This must match the date exactly as it’s written on the form.
                      </div>
                      <input class="govuk-input govuk-!-width-one-half" id="one-half" name="oneHalf" type="text">
                    </div>                   
                </div>
                <div class="govuk-radios__item">
                  <input class="govuk-radios__input" id="date-of-death-known-2" name="date-of-death-known" type="radio" value="No, only the date when their body was found" {{ checked("date-of-death-known", "No, only the date when their body was found") }} data-aria-controls="conditional-date-of-death-known-2">
                  <label class="govuk-label govuk-radios__label" for="date-of-death-known-2">
                    No, only the date when their body was found
                  </label>
                </div>
                <div class="govuk-radios__conditional govuk-radios__conditional--hidden" id="conditional-date-of-death-known-2">
                  <div class="govuk-form-group">
                    <fieldset class="govuk-fieldset" role="group" aria-describedby="date-of-death2" id="date-of-death2-fieldset">
                      <legend class="govuk-fieldset__legend govuk-fieldset__legend--s">
                      Enter the date the body was found
                      </legend>
                      <div id="date-of-death2-hint" class="govuk-hint">
                        For example, 23 11 2024.
                      </div>
                      <div class="govuk-date-input" id="date-of-death2">
                        <div class="govuk-date-input__item">
                          <div class="govuk-form-group">
                            <label class="govuk-label govuk-date-input__label" for="day-of-death2">
                              Day
                            </label>
                            <input class="govuk-input govuk-date-input__input govuk-input--width-2" id="day-of-death2" name="day-of-death2" value="{{data['day-of-death2']}}" >
                          </div>
                        </div>
                        <div class="govuk-date-input__item">
                          <div class="govuk-form-group">
                            <label class="govuk-label govuk-date-input__label" for="month-of-death2">
                              Month
                            </label>
                            <input class="govuk-input govuk-date-input__input govuk-input--width-2" id="month-of-death2" name="month-of-death2" value="{{data['month-of-death2']}}" >
                          </div>
                        </div>
                        <div class="govuk-date-input__item">
                          <div class="govuk-form-group">
                            <label class="govuk-label govuk-date-input__label" for="year-of-death2">
                              Year
                            </label>
                            <input class="govuk-input govuk-date-input__input govuk-input--width-4" id="year-of-death2" name="year-of-death2" value="{{data['year-of-death2']}}" >
                          </div>
                        </div>
                      </div>
                    </fieldset>
                  </div>
                  <div class="govuk-form-group">
                    <fieldset class="govuk-fieldset"  role="group" id="no-qualifier-fieldset">
                    <legend class="govuk-fieldset__legend govuk-fieldset__legend--s">
                    Set how the date will print on the register page
                      </legend>
                      <p class="govuk-body-m">
                        Date qualifier 
                         </p>
                      <div class="govuk-radios" data-module="govuk-radios">
                        <div class="govuk-radios__item">
                          <input class="govuk-radios__input" id="qualifier-3" name="qualifier" type="radio" value="On or about" {{ checked("qualifier", "On or about") }} aria-describedby="qualifier-item-hint">
                          <label class="govuk-label govuk-radios__label" for="qualifier-3">
                            On or about
                          </label>
                          <div id="qualifier-item-hint" class="govuk-hint govuk-radios__hint">
                            If the place of death is known.
                          </div>
                        </div>
                        <div class="govuk-radios__item">
                          <input class="govuk-radios__input" id="qualifier-4" name="qualifier" type="radio" value="Deceased found on" {{ checked("qualifier", "Deceased found on") }} aria-describedby="qualifier-2-item-hint">
                          <label class="govuk-label govuk-radios__label" for="qualifier-4">
                            Deceased found on
                          </label>
                          <div id="qualifier-2-item-hint" class="govuk-hint govuk-radios__hint">
                            If the place of death is not known.
                          </div>
                        </div>
                      </div>
                    </fieldset>
                  </div>
                  <div class="govuk-form-group">
                    <label class="govuk-label" for="readableDate">
                      Date
                    </label>
                    <div id="event-name-hint" class="govuk-hint">
                      This must match the date exactly as it’s written on the form.
                    </div>
                    <input class="govuk-input govuk-!-width-one-half" id="readableDate" name="readableDate" type="text">
                  </div>
                </div>
              </div>
            </fieldset>
          </div>
          <div class="govuk-button-group">
            {{ govukButton({
              text: "Continue",
              href: "/continuousImprovement/round1/task3-99revA/create-new-record/tasks/age-of-deceased"
            }) }}
          </div>
        </form>
      </div>
    </div>
  </main>

    <script>
      document.addEventListener('DOMContentLoaded', () => {
        const dayInput = document.getElementById('day-of-death2');
        const monthInput = document.getElementById('month-of-death2');
        const yearInput = document.getElementById('year-of-death2');
        const humanReadableDateInput = document.getElementById('readableDate');

      
      const updateHumanReadableDate = async () => {
         const day = dayInput.value;
        const month = monthInput.value;
        const year = yearInput.value;

        const humanReadableDate = formatHumanReadableDate(day, month, year);
        humanReadableDateInput.value = humanReadableDate;
      };

      dayInput.addEventListener('input', updateHumanReadableDate);
      monthInput.addEventListener('input', updateHumanReadableDate);
      yearInput.addEventListener('input', updateHumanReadableDate);

      });
      
    function formatHumanReadableDate(day, month, year) {
      const dayWords = [
        'First', 'Second', 'Third', 'Fourth', 'Fifth', 'Sixth', 'Seventh', 'Eighth', 'Ninth', 'Tenth',
        'Eleventh', 'Twelfth', 'Thirteenth', 'Fourteenth', 'Fifteenth', 'Sixteenth', 'Seventeenth', 'Eighteenth', 'Nineteenth', 'Twentieth',
        'Twenty first', 'Twenty second', 'Twenty third', 'Twenty fourth', 'Twenty fifth', 'Twenty sixth', 'Twenty seventh', 'Twenty eighth', 'Twenty ninth', 'Thirtieth',
        'Thirty first'
      ];
      const monthNames = [
          'January', 'February', 'March', 'April', 'May', 'June',
          'July', 'August', 'September', 'October', 'November', 'December'
      ];
      const monthIndex = parseInt(month, 10) - 1;
      const monthName = (month && monthIndex >= 0 && monthIndex < 12) ? monthNames[monthIndex] : '';

      let humanReadableDate = '';
       if (day) {
        day = parseInt(day, 10);
        if (day > 0 && day <= 31) {
          humanReadableDate += `${dayWords[day - 1]}`;
        }
      }
      if (month) {
          month = parseInt(month, 10);
          humanReadableDate += ` ${monthName}`;
      }
      if (year) {
          humanReadableDate += ` ${year}`;
      }

      return humanReadableDate.trim();
  }

function getDaySuffix(day) {
    if (day === 0) {
      return '';
    }
    const j = day % 10;
    const k = day % 100;
    if (j === 1 && k != 11) {
        return 'st';
    }
    if (j === 2 && k !== 12) {
        return 'nd';
    }
    if (j === 3 && k !== 13) {
        return 'rd';
    }
    return 'th';
}
    </script>
</div>
{% endblock %}
